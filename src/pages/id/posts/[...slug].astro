---
import { type CollectionEntry, getCollection } from "astro:content";

import PostLayout from "@components/PostLayout.astro";

export async function getStaticPaths() {
  const posts = (await getCollection("posts"))
    .filter((post) => !post.data.draft && post.data.lang === "id")
    .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
  return posts.map((post) => {
    // Remove /index.id or /indexid suffix from the slug
    const slug = post.slug
      .replace(/\/index\.id$|\/indexid$/, "")
      .replace(/\/indexid$/, "");
    return {
      params: { slug },
      props: post,
    };
  });
}
type Props = CollectionEntry<"posts">;

const post = Astro.props;
---

<PostLayout post={post} lang='id' />
